filename = "C:\Users\prime\WaterEnergy\src\data\VILLAGE_ok_Dist2_coord-.xlsx";
data = readtable(filename);

% –í–∏–±–∏—Ä–∞—î–º–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ —?—Ç–æ–≤–ø—Ü—ñ (—á–∏—?–ª–æ–≤—ñ –¥–∞–Ω—ñ)
selected_data_numeric = data(:, 24:32);

% –ó–∞–ø—É—?–∫–∞—î–º–æ kmeans –Ω–∞ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–∏—Ö —á–∏—?–ª–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö
% –û–ø–µ—Ä–∞—Ç–æ—Ä —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—? –∫–æ–º—ñ—Ä–æ–∫ {:} –∑–∞—?—Ç–æ—?–æ–≤—É—î—Ç—å—?—? –¥–æ –∑–º—ñ–Ω–Ω–æ—ó selected_data_numeric, 
% —?–∫–∞ —î —Ç–∞–±–ª–∏—Ü–µ—é. –¶–µ–π –æ–ø–µ—Ä–∞—Ç–æ—Ä —Ä–æ–∑–ø–∞–∫–æ–≤—É—î –≤–º—ñ—?—Ç –∫–æ–∂–Ω–æ—ó –∫–æ–º—ñ—Ä–∫–∏ —Ç–∞–±–ª–∏—Ü—ñ.
% –û–ø–µ—Ä–∞—Ç–æ—Ä –æ–±'—î–¥–Ω–∞–Ω–Ω—? ',:' –≤–∏–∫–æ—Ä–∏—?—Ç–æ–≤—É—î—Ç—å—?—? –¥–ª—? –æ–±'—î–¥–Ω–∞–Ω–Ω—? –≤–º—ñ—?—Ç—É –≤—?—ñ—Ö –∫–æ–º—ñ—Ä–æ–∫ –≤ –æ–¥–∏–Ω –º–∞—?–∏–≤.
clust = kmeans(selected_data_numeric{:,:}, 9);

% [s,h] = silhouette(___) –±—É–¥—É—î —?–∏–ª—É–µ—Ç–∏ —ñ –ø–æ–≤–µ—Ä—Ç–∞—î —Ö–µ–Ω–¥–ª —Ñ—ñ–≥—É—Ä–∏ h –Ω–∞ –¥–æ–¥–∞—Ç–æ–∫ –¥–æ –∑–Ω–∞—á–µ–Ω—å —?–∏–ª—É–µ—Ç—ñ–≤ —É s.
% –ó–Ω–∞—á–µ–Ω–Ω—? —?–∏–ª—É–µ—Ç—É, —â–æ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å—?—? —É –≤–∏–≥–ª—?–¥—ñ –≤–µ–∫—Ç–æ—Ä–∞ n –Ω–∞ 1 –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—?–º–∏ –≤—ñ–¥ -1 –¥–æ 1. 
% –ó–Ω–∞—á–µ–Ω–Ω—? —?–∏–ª—É–µ—Ç—É –≤–∏–º—ñ—Ä—é—î, –Ω–∞—?–∫—ñ–ª—å–∫–∏ —Ç–æ—á–∫–∞ –ø–æ–¥—ñ–±–Ω–∞ –¥–æ —Ç–æ—á–æ–∫ —?–≤–æ–≥–æ –∫–ª–∞—?—Ç–µ—Ä–∞ 
% —É –ø–æ—Ä—ñ–≤–Ω—?–Ω–Ω—ñ –∑ —Ç–æ—á–∫–∞–º–∏ –≤ —ñ–Ω—à–∏—Ö –∫–ª–∞—?—Ç–µ—Ä–∞—Ö. –ó–Ω–∞—á–µ–Ω–Ω—? –≤–∞—Ä—ñ—é—é—Ç—å—?—? –≤—ñ–¥ -1 –¥–æ 1. 
% –í–∏—?–æ–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—? —?–∏–ª—É–µ—Ç—É –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ —Ç–æ—á–∫–∞ –¥–æ–±—Ä–µ —?–ø—ñ–≤–ø–∞–¥–∞—î –∑—ñ —?–≤–æ—ó–º –∫–ª–∞—?—Ç–µ—Ä–æ–º 
% —ñ –ø–æ–≥–∞–Ω–æ –∑ —ñ–Ω—à–∏–º–∏ –∫–ª–∞—?—Ç–µ—Ä–∞–º–∏.
[value_silhouette, h] = silhouette(selected_data_numeric{:,:}, clust);

% –ü–æ—à—É–∫ —Ü–µ–Ω—Ç—Ä—ñ–≤ –∫–ª–∞—?—Ç–µ—Ä—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —?—É–±—Ç—Ä–∞–∫—Ç–∏–≤–Ω–æ—ó –∫–ª–∞—?—Ç–µ—Ä–∏–∑–∞—Ü—ñ—ó
% –ó–Ω–∞—Ö–æ–¥–∏–º–æ —Ü–µ–Ω—Ç—Ä–∏ –∫–ª–∞—?—Ç–µ—Ä—ñ–≤, –≤–∏–∫–æ—Ä–∏—?—Ç–æ–≤—É—é—á–∏ –æ–¥–Ω–∞–∫–æ–≤–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω –≤–ø–ª–∏–≤—É –¥–ª—? –≤—?—ñ—Ö –≤–∏–º—ñ—Ä—ñ–≤.
centers = subclust(selected_data_numeric{:,:}, 0.9);

% –ü—Ä–∏–ø—É—?—Ç–∏–º–æ, —â–æ —Ö–æ—á–µ–º–æ –≤–∏–∫–æ—Ä–∏—?—Ç–æ–≤—É–≤–∞—Ç–∏ —?—Ç–æ–≤–ø—Ü—ñ 24 —ñ 25 –¥–ª—? –¥—ñ–∞–≥—Ä–∞–º–∏ —Ä–æ–∑—?—ñ—é–≤–∞–Ω–Ω—?
scatter(selected_data_numeric{:,"CITY2_NEAR"}, selected_data_numeric{:,"RD_m2_NEAR"});
xlabel('Water NEAR');
ylabel('power NEAR');
title('–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—?—?–µ—?–Ω–∏—?');

% –í–∏–∫–æ—Ä–∏—?—Ç–∞–Ω–Ω—? —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –¥–ª—? –≤–∏–¥–∞–ª–µ–Ω–Ω—? —Ä—?–¥–∫—ñ–≤ –∑ –Ω—É–ª—?–º–∏
% selected_data_numeric{:,:}: —Ü–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—? –∫–æ–º—ñ—Ä–æ–∫, —?–∫–∏–π –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –≤–∞—à—É —Ç–∞–±–ª–∏—Ü—é 
% selected_data_numeric —É –∑–≤–∏—á–∞–π–Ω–∏–π –º–∞—?–∏–≤ —á–∏—?–ª–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö. –í–∞—à—ñ –¥–∞–Ω—ñ —Ç–µ–ø–µ—Ä –ø—Ä–µ–¥—?—Ç–∞–≤–ª–µ–Ω—ñ —?–∫ –º–∞—Ç—Ä–∏—Ü—?, 
% –¥–µ –∫–æ–∂–µ–Ω —Ä—?–¥–æ–∫ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ä—?–¥–∫—É –∑ —Ç–∞–±–ª–∏—Ü—ñ, –∞ –∫–æ–∂–Ω–∏–π —?—Ç–æ–≤–ø–µ—Ü—å - —?—Ç–æ–≤–ø—Ü—é –∑ —Ç–∞–±–ª–∏—Ü—ñ.
% all(selected_data_numeric{:,:} ~= 0, 2): –¢—É—Ç –º–∏ –ø–æ—Ä—ñ–≤–Ω—é—î–º–æ –∫–æ–∂–µ–Ω –µ–ª–µ–º–µ–Ω—Ç –º–∞—Ç—Ä–∏—Ü—ñ –∑ –Ω—É–ª–µ–º 
% (selected_data_numeric{:,:} ~= 0). –¶–µ –ø–æ–≤–µ—Ä—Ç–∞—î –º–∞—Ç—Ä–∏—Ü—é —Ç–∏—Ö —?–∞–º–∏—Ö —Ä–æ–∑–º—ñ—Ä—ñ–≤, —â–æ —ñ selected_data_numeric, 
% –∞–ª–µ –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—?–º–∏ true —Ç–∞–º, –¥–µ –µ–ª–µ–º–µ–Ω—Ç–∏ –Ω–µ —Ä—ñ–≤–Ω—ñ –Ω—É–ª—é, —ñ false —Ç–∞–º, –¥–µ –≤–æ–Ω–∏ —Ä—ñ–≤–Ω—ñ –Ω—É–ª—é. 
% –§—É–Ω–∫—Ü—ñ—? all –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–≤—ñ—Ä—?—î, —á–∏ –≤—?—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –≤ –∫–æ–∂–Ω–æ–º—É —Ä—?–¥–∫—É —Ü—ñ—î—ó –º–∞—Ç—Ä–∏—Ü—ñ –Ω–µ —Ä—ñ–≤–Ω—ñ –Ω—É–ª—é. 
% –Ø–∫—â–æ —Ü–µ —Ç–∞–∫, —Ç–æ –≤–æ–Ω–∞ –ø–æ–≤–µ—Ä—Ç–∞—î true, —ñ–Ω–∞–∫—à–µ - false.
% filtered_data = selected_data_numeric(all(selected_data_numeric{:,:} ~= 0, 2), :);: —Ü–µ–π —Ä—?–¥–æ–∫ –æ–±–∏—Ä–∞—î 
% —Ç—ñ–ª—å–∫–∏ —Ç—ñ —Ä—?–¥–∫–∏ –∑ selected_data_numeric, –¥–ª—? —?–∫–∏—Ö —É—?—ñ –∑–Ω–∞—á–µ–Ω–Ω—? –Ω–µ —Ä—ñ–≤–Ω—ñ –Ω—É–ª—é. 
% –¶–µ –∑–∞–±–µ–∑–ø–µ—á—É—î –≤—ñ–¥–±—ñ—Ä –ª–∏—à–µ —Ç–∏—Ö –¥–∞–Ω–∏—Ö, –¥–µ –≤—?—ñ –∑–Ω–∞—á–µ–Ω–Ω—? —?—Ç–æ–≤–ø—Ü—ñ–≤ –Ω–µ —î –Ω—É–ª—å–æ–≤–∏–º–∏.
filtered_data = selected_data_numeric(all(selected_data_numeric{:,:} ~= 0, 2), :);

opts = statset('Display','final');
[idx,C] = kmeans(filtered_data{:,:}, 9, 'Distance','cityblock',...
    'Replicates',5,'Options',opts);

figure;
plot(selected_data_numeric{idx==1,"power_NEAR"}, selected_data_numeric{idx==1,"Water_NEAR"}, 'b.','MarkerSize',12);

hold on;
plot(selected_data_numeric{idx==2,"power_NEAR"}, selected_data_numeric{idx==2,"Water_NEAR"}, 'r.','MarkerSize',12);
%   
% plot(C(:,1),C(:,2),'kx',...
%      'MarkerSize',15,'LineWidth',3) 
legend('Cluster 1','Cluster 2','Cluster 3', 'Centroids',...
       'Location','NW')
title 'Cluster Assignments and Centroids'
hold off